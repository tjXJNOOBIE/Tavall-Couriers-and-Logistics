<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Merchant Scan</title>
    <link rel="stylesheet" href="/css/style.css"/>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

<div class="scan-overlay fade-in" data-scan-mode="merchant-intake">
    <div class="scan-popup">
        <div class="scan-topbar">
            <span class="text-white font-mono text-xs opacity-70">POD SCAN v1.0</span>
            <a class="scan-close" th:href="@{/dashboard/merchant}">
                <i data-lucide="x" class="w-8 h-8"></i>
            </a>
        </div>

        <div class="scan-frame">
            <div class="scan-video-wrap">
                <video id="live-feed" autoplay muted playsinline></video>
                <canvas id="frame-buffer" style="display:none;"></canvas>
            </div>
            <div class="scan-state-overlay">
                <div id="scan-state-badge" class="scan-state-badge">SEARCHING</div>
                <div class="scan-state-pulse" aria-hidden="true"></div>
            </div>
        </div>

        <div class="scan-actions scan-camera-actions">
            <button id="btn-toggle-source" class="scan-toggle" type="button">Switch to Screen Share</button>
        </div>
    </div>
</div>

<script th:inline="javascript">
    window.APP = window.APP || {};
    window.APP.endpoints = window.APP.endpoints || {};
    window.APP.endpoints.configHandshake = /*[[@{/internal/api/v1/config/handshake}]]*/ "/internal/api/v1/config/handshake";
</script>
<script src="/js/camera.js" defer></script>
<script>
    lucide.createIcons();
</script>
</body>
</html>
