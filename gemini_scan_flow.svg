<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="520" viewBox="0 0 1000 520">
    <style>
        .box { fill: #f7f7f7; stroke: #333; stroke-width: 2; }
        .title { font: 18px sans-serif; font-weight: 700; }
        .text { font: 14px sans-serif; }
        .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
    </style>
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
        </marker>
    </defs>

    <text x="30" y="32" class="title">Gemini 3 Scan Flow</text>

    <rect x="40" y="70" width="220" height="70" class="box" />
    <text x="60" y="105" class="text">Camera Feed</text>
    <text x="60" y="125" class="text">(PNG frame bytes)</text>

    <rect x="310" y="70" width="240" height="70" class="box" />
    <text x="330" y="105" class="text">Local Doc Detection</text>
    <text x="330" y="125" class="text">(UUID detection)</text>

    <rect x="600" y="70" width="320" height="70" class="box" />
    <text x="620" y="105" class="text">Gemini 3 Flash</text>
    <text x="620" y="125" class="text">(OCR + Label Extraction)</text>

    <rect x="310" y="190" width="240" height="70" class="box" />
    <text x="330" y="225" class="text">Structured Gemini Response</text>
    <text x="330" y="245" class="text">(ScanResponse.java)</text>

    <rect x="600" y="190" width="320" height="70" class="box" />
    <text x="620" y="225" class="text">Cache Updates</text>
    <text x="620" y="245" class="text">Scan + Delivery State</text>

    <rect x="40" y="320" width="220" height="90" class="box" />
    <text x="60" y="355" class="text">Async Task Runner</text>
    <text x="60" y="375" class="text">(AsyncTask.java)</text>

    <rect x="310" y="320" width="240" height="90" class="box" />
    <text x="330" y="355" class="text">Web UI Updates</text>
    <text x="330" y="375" class="text">(Scanning Flow)</text>

    <line x1="260" y1="105" x2="310" y2="105" class="arrow" />
    <line x1="550" y1="105" x2="600" y2="105" class="arrow" />
    <line x1="430" y1="140" x2="430" y2="190" class="arrow" />
    <line x1="550" y1="225" x2="600" y2="225" class="arrow" />
    <line x1="150" y1="140" x2="150" y2="320" class="arrow" />
    <line x1="260" y1="365" x2="310" y2="365" class="arrow" />
</svg>